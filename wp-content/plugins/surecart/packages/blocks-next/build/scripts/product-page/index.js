import*as t from"@wordpress/interactivity";import*as e from"@surecart/checkout-service";var n={445:function(t,e,n){function o(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const o=new CustomEvent("scProductViewed",{detail:{id:t?.id,name:t?.name,price:e,permalink:t?.permalink,prices:t?.prices,variant_options:t?.variant_options?.data,product_collections:t?.product_collections,quantity:n},bubbles:!0});document.dispatchEvent(o)}n.r(e),n.d(e,{scProductViewed:function(){return o}})}},o={};function a(t){var e=o[t];if(void 0!==e)return e.exports;var i=o[t]={exports:{}};return n[t](i,i.exports,a),i.exports}a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};!function(){a.d(i,{O:function(){return _},M:function(){return b}});var n,o,r=(n={getContext:function(){return t.getContext},store:function(){return t.store}},o={},a.d(o,n),o),s=function(t){var e={};return a.d(e,t),e}({addCheckoutLineItem:function(){return e.addCheckoutLineItem}});const{actions:c}=(0,r.store)("surecart/checkout"),{actions:u,state:l}=(0,r.store)("surecart/cart"),{addQueryArgs:d}=wp.url,{speak:p}=wp.a11y,{sprintf:g,__}=wp.i18n,{scProductViewed:m}=a(445),v=t=>"keydown"===t.type&&"Enter"!==t.key&&"Space"!==t.code,{state:f,actions:y}=(0,r.store)("surecart/product-page",{state:{get quantity(){const{selectedPrice:t,quantity:e}=(0,r.getContext)();return t?.ad_hoc?1:e},get selectedAmount(){const t=(0,r.getContext)();if(!t)return!0;const{selectedPrice:e,prices:n}=t;return n?.length>1?e?.amount||"":f.selectedVariant?.amount||e?.amount||""},get selectedDisplayAmount(){const{prices:t,selectedPrice:e}=(0,r.getContext)();return t?.length>1?e?.display_amount||"":f.selectedVariant?.display_amount||e?.display_amount||""},get selectedVariant(){const t=(0,r.getContext)();if(!t)return{};const{variants:e,variantValues:n}=t;return n?_({variants:e,values:n||{}}):{}},get isOnSale(){const t=(0,r.getContext)();if(!t)return!0;const{selectedPrice:e}=t;return e?.is_on_sale||!1},get isOptionUnavailable(){const t=(0,r.getContext)();if(!t)return!0;const{optionNumber:e,option_value:n,product:o,variants:a,variantValues:i}=t;return b(parseInt(e),n,i,a,o)},get isOptionSelected(){const t=(0,r.getContext)();if(!t)return!0;const{optionNumber:e,option_value:n,variantValues:o}=t;return o?.[`option_${e}`]===n},get isOptionValueSelected(){const t=(0,r.getContext)();if(!t)return!0;const{optionValue:e,variantValues:n}=t;return!e||Object.values(n).map((t=>t.toLowerCase())).includes(e.toLowerCase())},get shouldDisplayImage(){const t=(0,r.getContext)();if(!t)return!0;const{variants:e}=t;return!e?.length||f.isOptionValueSelected},get imageDisplay(){return f.shouldDisplayImage?"initial":"none"},get isPriceSelected(){const t=(0,r.getContext)();if(!t)return!0;const{price:e,selectedPrice:n}=t;return n?.id===e?.id},get checkoutUrl(){const{checkoutUrl:t}=(0,r.getContext)();return d(t,{line_items:[f.lineItem],no_cart:!0})},get buttonText(){const t=(0,r.getContext)();if(!t)return!0;const{text:e,outOfStockText:n,unavailableText:o}=t;return f.isSoldOut?n:f.isUnavailable?o:e},get isUnavailable(){const t=(0,r.getContext)();if(!t)return!0;const{product:e,variants:n}=t;return!!e?.archived||!!f?.isSoldOut||!(!n?.length||f.selectedVariant?.id)},get isSoldOut(){const t=(0,r.getContext)();if(!t)return!0;const{product:e}=t;return!e?.has_unlimited_stock&&(f.selectedVariant?.id?f.selectedVariant?.available_stock<=0:e?.available_stock<=0)},get lineItem(){const{adHocAmount:t,selectedPrice:e}=(0,r.getContext)();return{price:e?.id,quantity:Math.max(e?.ad_hoc?1:f.quantity,1),...e?.ad_hoc?{ad_hoc_amount:e?.is_zero_decimal?t:100*t}:{},...f.selectedVariant?.id?{variant:f.selectedVariant?.id}:{}}},get disabled(){const{selectedPrice:t,product:e}=(0,r.getContext)();return t?.archived||e?.archived},get isQuantityDisabled(){const{selectedPrice:t}=(0,r.getContext)();return!!t?.ad_hoc},get isQuantityIncreaseDisabled(){return f.isQuantityDisabled},get isQuantityDecreaseDisabled(){return f.isQuantityDisabled||f.quantity<=1}},actions:{addToCart:async t=>{const e=Object.values(t.submitter.dataset).includes("context.busy");!e&&u.open();const n=(0,r.getContext)(),{mode:o,formId:a,product:i}=n;try{n.busy=!0;const t=await(0,s.addCheckoutLineItem)(f.lineItem);c.setCheckout(t,o,a),e&&u.open(),l.label=g(/* translators: %s: product name */
__("%s has been added to your cart.","surecart"),i?.name)}catch(t){console.error(t)}finally{n.busy=!1}}},callbacks:{*init(){(window?.dataLayer||window?.gtag)&&(yield import("@surecart/google-events")),window?.fbq&&(yield import("@surecart/facebook-events"));const{selectedPrice:t,product:e}=(0,r.getContext)();m(e,t,f.quantity)},handleSubmit:t=>(t.preventDefault(),t?.submitter?.value?window.location.assign(t.submitter.value):y.addToCart(t)),setOption:t=>{if(v(t))return!0;t.preventDefault();const{variantValues:e,optionNumber:n,option_value:o,option_name:a,option_name_slug:i,option_value_slug:s,urlPrefix:c}=(0,r.getContext)(),u=o||t?.target?.value;e[`option_${n}`]=u,o&&a&&window.history.replaceState({},"",d(window.location.href,{[`${c?c+"-":""}${i}`]:s}))},setPrice:t=>{if(v(t))return!0;t?.preventDefault();const e=(0,r.getContext)(),{price:n,prices:o}=e,a=(o||[]).find((t=>t.id===n?.id));e.selectedPrice=a,e.adHocAmount=null},setAdHocAmount:t=>{(0,r.getContext)().adHocAmount=parseFloat(t.target.value)},onQuantityChange:t=>{const e=(0,r.getContext)();e.quantity=Math.max(parseInt(t.target.value),1),p(`Quantity set to ${e.quantity}`,"polite")},onQuantityDecrease:t=>{if(v(t))return!0;t?.preventDefault();const e=(0,r.getContext)();f.isQuantityDisabled||(e.quantity=Math.max(1,f.quantity-1),p(`Quantity set to ${e.quantity}`,"polite"))},onQuantityIncrease:t=>{if(v(t))return!0;t?.preventDefault();const e=(0,r.getContext)();e.quantity=f.quantity+1,p(`Quantity set to ${e.quantity}`,"polite")}}}),_=t=>{let{variants:e,values:n}=t;const o=Object.keys(n||{});for(const t of e){const e=["option_1","option_2","option_3"].map((e=>t[e])).filter((t=>null!=t));if(e?.length===o?.length&&o.every((t=>e.includes(n[t]))))return t}return null},b=function(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4?arguments[4]:void 0;if(a?.has_unlimited_stock)return!1;if(1===t){const t=(o||[]).filter?.((t=>t.option_1===e));return Math.max(...t.map((t=>t.available_stock)))<=0}if(2===t){const t=(o||[]).filter((t=>t?.option_1===n.option_1&&t.option_2===e));return Math.max(...t.map((t=>t.available_stock)))<=0}const i=(o||[]).filter((t=>t?.option_1===n.option_1&&t?.option_2===n.option_2&&t.option_3===e));return Math.max(...i.map((t=>t.available_stock)))<=0}}();var r=i.O,s=i.M;export{r as getVariantFromValues,s as isProductVariantOptionSoldOut};