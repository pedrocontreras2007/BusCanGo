import{r as i,h as t,F as e}from"./p-e97fde0a.js";import{a as s}from"./p-9a298389.js";import{p as n,i as a}from"./p-6ec14893.js";import{a as l}from"./p-401e165e.js";import"./p-d3366af3.js";import"./p-3f6362a4.js";function o(i,t={timeStyle:"medium",dateStyle:"full"},e=[]){const s=new Intl.DateTimeFormat(e,t);return s.format(new Date(i*1e3))}const r=(i,t)=>["BIF","BYR","CLP","DJF","GNF","ISK","JPY","KMF","KRW","PYG","RWF","UGX","VND","VUV","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XDR","XOF","XPD","XPF","XPT","XTS"].includes(t?.toUpperCase())?i:i/100;const d=(i,t="")=>new Intl.NumberFormat([],{style:"currency",currency:t.toUpperCase(),currencyDisplay:"symbol"}).format(r(i,t.toUpperCase()));const c=":host{display:block}.subscription-details{display:grid;gap:0.25em;color:var(--sc-input-label-color)}.subscription-details__missing-method{display:flex;align-items:center;gap:var(--sc-spacing-x-small)}";const u=c;const v=class{constructor(t){i(this,t);this.subscription=undefined;this.pendingPrice=undefined;this.hideRenewalText=undefined;this.activationsModal=undefined;this.loading=undefined;this.hasPendingUpdate=undefined}renderName(){var i,t,e;if(typeof((t=(i=this.subscription)===null||i===void 0?void 0:i.price)===null||t===void 0?void 0:t.product)!=="string"){return n((e=this.subscription)===null||e===void 0?void 0:e.price)}return wp.i18n.__("Subscription","surecart")}async handleSubscriptionChange(){var i,t,e,s;this.hasPendingUpdate=!!((t=Object.keys(((i=this===null||this===void 0?void 0:this.subscription)===null||i===void 0?void 0:i.pending_update)||{}))===null||t===void 0?void 0:t.length);if(((s=(e=this===null||this===void 0?void 0:this.subscription)===null||e===void 0?void 0:e.pending_update)===null||s===void 0?void 0:s.price)&&!(this===null||this===void 0?void 0:this.pendingPrice)&&!this.hideRenewalText){this.pendingPrice=await this.fetchPrice(this.subscription.pending_update.price)}}componentWillLoad(){this.handleSubscriptionChange()}async fetchPrice(i){try{this.loading=true;const t=await s({path:l(`surecart/v1/prices/${i}`,{expand:["product"]})});return t}catch(i){console.error(i)}finally{this.loading=false}}renderRenewalText(){var i,e,s,n,l,r,c,u,v,h,p,f,m,y,b,w,g,k,x,X,Y,P,_,C;const R=t("sc-subscription-status-badge",{subscription:this===null||this===void 0?void 0:this.subscription});if(((i=this===null||this===void 0?void 0:this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end)&&((e=this===null||this===void 0?void 0:this.subscription)===null||e===void 0?void 0:e.current_period_end_at)){return t("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan will be canceled on %s","surecart"),o(this.subscription.current_period_end_at))},R," ",wp.i18n.sprintf(wp.i18n.__("Your plan will be canceled on","surecart"))," ",t("sc-format-date",{date:this.subscription.current_period_end_at*1e3,month:"long",day:"numeric",year:"numeric"}))}if(this.hasPendingUpdate){if(!this.pendingPrice&&!((n=(s=this.subscription)===null||s===void 0?void 0:s.pending_update)===null||n===void 0?void 0:n.ad_hoc_amount)){return t("sc-skeleton",null)}if((r=(l=this.subscription)===null||l===void 0?void 0:l.pending_update)===null||r===void 0?void 0:r.ad_hoc_amount){return t("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan switches to %1$s on %2$s","surecart"),d((u=(c=this.subscription)===null||c===void 0?void 0:c.pending_update)===null||u===void 0?void 0:u.ad_hoc_amount,((v=this.pendingPrice)===null||v===void 0?void 0:v.currency)||((p=(h=this.subscription)===null||h===void 0?void 0:h.price)===null||p===void 0?void 0:p.currency)),o(this.subscription.current_period_end_at))},wp.i18n.__("Your plan switches to","surecart")," ",t("strong",null,t("sc-format-number",{type:"currency",currency:((f=this.pendingPrice)===null||f===void 0?void 0:f.currency)||((y=(m=this.subscription)===null||m===void 0?void 0:m.price)===null||y===void 0?void 0:y.currency),value:(w=(b=this.subscription)===null||b===void 0?void 0:b.pending_update)===null||w===void 0?void 0:w.ad_hoc_amount})," ",a(this.pendingPrice||((g=this.subscription)===null||g===void 0?void 0:g.price)))," ",wp.i18n.__("on","surecart")," ",t("sc-format-date",{date:this.subscription.current_period_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}return t("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan switches to %1$s on %2$s","surecart"),this.pendingPrice.product.name,o(this.subscription.current_period_end_at))},wp.i18n.__("Your plan switches to","surecart")," ",t("strong",null,this.pendingPrice.product.name)," ",wp.i18n.__("on","surecart")," ",t("sc-format-date",{date:this.subscription.current_period_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}if(((k=this===null||this===void 0?void 0:this.subscription)===null||k===void 0?void 0:k.status)==="trialing"&&((x=this===null||this===void 0?void 0:this.subscription)===null||x===void 0?void 0:x.trial_end_at)){return t("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your plan begins on %s.","surecart"),o(this.subscription.trial_end_at))},R," ",wp.i18n.sprintf(wp.i18n.__("Your plan begins on","surecart"))," ",t("sc-format-date",{date:(X=this===null||this===void 0?void 0:this.subscription)===null||X===void 0?void 0:X.trial_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}if(((Y=this.subscription)===null||Y===void 0?void 0:Y.status)==="active"&&((P=this.subscription)===null||P===void 0?void 0:P.current_period_end_at)){return t("span",{"aria-label":wp.i18n.sprintf(wp.i18n.__("Renewal Update - Your next payment is on %s","surecart"),o(this.subscription.current_period_end_at))},R," ",((_=this.subscription)===null||_===void 0?void 0:_.remaining_period_count)===null?wp.i18n.__("Your plan renews on","surecart"):wp.i18n.__("Your next payment is on","surecart")," ",t("sc-format-date",{date:(C=this===null||this===void 0?void 0:this.subscription)===null||C===void 0?void 0:C.current_period_end_at,type:"timestamp",month:"long",day:"numeric",year:"numeric"}))}return R}getActivations(){var i,t,e,s;return(((s=(e=(t=(i=this.subscription)===null||i===void 0?void 0:i.purchase)===null||t===void 0?void 0:t.license)===null||e===void 0?void 0:e.activations)===null||s===void 0?void 0:s.data)||[]).filter((i=>i===null||i===void 0?void 0:i.counted))}renderActivations(){var i;const e=this.getActivations();if(!(e===null||e===void 0?void 0:e.length))return null;return t("sc-flex",{justifyContent:"flex-start",alignItems:"center"},t("sc-tag",{size:"small"},(i=e===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.name),(e===null||e===void 0?void 0:e.length)>1&&t("sc-text",{style:{"--font-size":"var(--sc-font-size-small)",cursor:"pointer"},onClick:i=>{i.preventDefault();i.stopImmediatePropagation();this.activationsModal=true}},"+ ",(e===null||e===void 0?void 0:e.length)-1," More"))}showWarning(){var i,t,e,s,n,a,l;if(((i=this.subscription)===null||i===void 0?void 0:i.payment_method)||this.subscription.manual_payment){return false}if(!["active","past_due","unpaid","incomplete"].includes((t=this.subscription)===null||t===void 0?void 0:t.status)){return false}if((s=(e=this.subscription)===null||e===void 0?void 0:e.price)===null||s===void 0?void 0:s.ad_hoc){return((n=this.subscription)===null||n===void 0?void 0:n.ad_hoc_amount)!==0}return((l=(a=this.subscription)===null||a===void 0?void 0:a.price)===null||l===void 0?void 0:l.amount)!==0}render(){return t("div",{key:"5489791eb6c85eff31643decfad2095c5d589b47",class:"subscription-details"},this.hasPendingUpdate&&t("div",{key:"b8b296de4d485af8631d3b2c84fa35d6c8db5e62"},t("sc-tag",{key:"cf9561bdc8be63306120fa9dec6fc8228ec95ad8",size:"small",type:"warning"},wp.i18n.__("Update Scheduled","surecart"))),t("sc-flex",{key:"561940da92520d098a55ef7f0cd58fa33d900f54",alignItems:"center",justifyContent:"flex-start"},t("sc-text",{key:"37f84bfd3e2a0c7b7cbeb8d4ff6d58699a81a6bd","aria-label":wp.i18n.sprintf(wp.i18n.__("Plan name - %s","surecart"),this.renderName()),style:{"--font-weight":"var(--sc-font-weight-bold)"}},this.renderName()),this.renderActivations()),!this.hideRenewalText&&t("div",{key:"441d36a82787b20d9d7e68e4e52a92276aab9300"},this.renderRenewalText()," "),t("slot",{key:"f1ee8e09966e58dbed98c636022255473395183a"}),t("sc-dialog",{key:"6d99e88f6570148c3558fd07ec91e40c17a9e606",label:wp.i18n.__("Activations","surecart"),onScRequestClose:()=>this.activationsModal=false,open:!!this.activationsModal},t("sc-card",{key:"9487d0d86c5a6a7e7d5be718264c4cb4df2c4138","no-padding":true,style:{"--overflow":"hidden"}},t("sc-stacked-list",{key:"af80104013dfeba4be209a86111d1e33e5b0a2a1"},(this.getActivations()||[]).map((i=>t("sc-stacked-list-row",{style:{"--columns":"2"},mobileSize:0},t("sc-text",{style:{"--line-height":"var(--sc-line-height-dense)"}},t("strong",null,i===null||i===void 0?void 0:i.name),t("div",null,t("sc-text",{style:{"--color":"var(--sc-color-gray-500)"}},i===null||i===void 0?void 0:i.fingerprint))),t("sc-text",{style:{"--color":"var(--sc-color-gray-500)"}},t("sc-format-date",{type:"timestamp",month:"short",day:"numeric",year:"numeric",date:i===null||i===void 0?void 0:i.created_at})))))))),this.showWarning()&&t("div",{key:"aa1a095f5336ad5a087fbdae31bb54835169b61b"},t("sc-tag",{key:"7d84726454578aa7afbbde68f2d8de8303167ca9",type:"warning"},t("div",{key:"03f15cc1a9a7f940a305c0b1f40f25cdb4c3d33a",class:"subscription-details__missing-method"},t("sc-icon",{key:"bd9c35105c34a5dae972a9aca47c5daa4bc4fb7b",name:"alert-triangle"}),wp.i18n.__("Payment Method Missing","surecart")))))}static get watchers(){return{subscription:["handleSubscriptionChange"]}}};v.style=u;const h=":host{display:inline-block}";const p=h;const f=class{constructor(t){i(this,t);this.status=undefined;this.subscription=undefined;this.size="medium";this.pill=false;this.clearable=false}getType(){var i,t,e;if((i=this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end){return"info"}switch(this.status||((t=this.subscription)===null||t===void 0?void 0:t.status)){case"incomplete":return"warning";case"trialing":return"info";case"active":return"success";case"completed":return"success";case"past_due":return"warning";case"canceled":if((e=this.subscription)===null||e===void 0?void 0:e.restore_at){return"info"}return"danger";case"unpaid":return"warning"}}getText(){var i,s,n,a,l;if(((i=this.subscription)===null||i===void 0?void 0:i.cancel_at_period_end)&&this.subscription.current_period_end_at&&((s=this.subscription)===null||s===void 0?void 0:s.status)!=="canceled"){return t(e,null,!!((n=this.subscription)===null||n===void 0?void 0:n.restore_at)?wp.i18n.__("Pauses","surecart"):wp.i18n.__("Cancels","surecart")," ",t("sc-format-date",{type:"timestamp",date:this.subscription.current_period_end_at,month:"short",day:"numeric"}))}switch(this.status||((a=this.subscription)===null||a===void 0?void 0:a.status)){case"incomplete":return wp.i18n.__("Incomplete","surecart");case"trialing":return wp.i18n.__("Trialing","surecart");case"active":return wp.i18n.__("Active","surecart");case"past_due":return wp.i18n.__("Past Due","surecart");case"canceled":if((l=this.subscription)===null||l===void 0?void 0:l.restore_at){return"Paused"}return wp.i18n.__("Canceled","surecart");case"completed":return wp.i18n.__("Completed","surecart");case"unpaid":return wp.i18n.__("Unpaid","surecart")}}render(){return t("sc-tag",{key:"18242a6f1f4444ae4badbc4885ae5c6d9d6053a4","aria-label":wp.i18n.sprintf(wp.i18n.__("Plan Status - %s","surecart"),this.getText()),type:this.getType()},this.getText())}};f.style=p;export{v as sc_subscription_details,f as sc_subscription_status_badge};
//# sourceMappingURL=p-8ee83f4c.entry.js.map